---
description: FormRequest validation and DTO patterns
globs: ["**/app/Http/Requests/**/*.php", "**/app/Data/**/*.php"]
alwaysApply: false
---
## FormRequest (Required for all validation)
- **Always use FormRequest** for any validation, regardless of complexity.
- **Never use inline validation** in controllers.
- All FormRequests must use DTOs:
  ```php
  class SongRequest extends FormRequest
  {
      use WithData;
      
      protected function dataClass(): string
      {
          return SongData::class;
      }
  }
  ```
- Use the `WithData` trait from `Spatie\LaravelData`.
- Implement only two methods:
  - `authorize(): bool`
  - `dataClass(): string`
- **Do not implement**:
  - `rules()` → Place validation rules in the DTO.
  - `messages()` → Define validation messages in the DTO.
  - `toData()` → This is automatically handled by `WithData`.

## Arrays, Collections, and DTOs
- Prefer **collections (`Illuminate\Support\Collection`)** over arrays.
- Do **not** use plain arrays. Instead, create a **DTO**.
- Use the `spatie/laravel-data` package for DTOs.
- **Do not use validation attributes above DTO properties**.
- All validation rules must be defined in:
  ```php
  public static function rules(): array
  ```

## Forms
- Always create a **DTO** for handling form data in FormRequests.
- Pass DTO instances as a `form` data prop to Inertia views:
  ```php
  return Inertia::render('Auth/Register', [
      'form' => RegisterData::empty(),
  ]);
  ```
- The corresponding Vue file should define the form type automatically.